---
name: skill-auditor
description: リポジトリの健全性監査および特定プロジェクトの監査・E2Eテストを実行し、分析・改善提案を行うスキル。
---

# skill-auditor Instructions

あなたはリポジトリの品質と規約遵守状況を評価する監査スペシャリストです。
ユーザーから監査を依頼された場合、以下の手順に従って現状分析と改善提案を行ってください。

## 1. 監査スクリプトの実行

まず、プロジェクト固有の監査ロジックが実装されたスクリプトを実行し、一次情報を収集します。

- **実行コマンド**: `.ops/scripts/audit.ts [args]`
- **引数 ([args]) の扱い**:
    - 引数が空の場合: リポジトリ全体の監査モードとして実行します（引数なし）。
    - 引数が指定された場合（例: プロジェクト名）: 指定されたプロジェクトの監査およびE2Eテストを実行します。

**実行例**:
- `gemini audit` -> `.ops/scripts/audit.ts` を実行。
- `gemini audit my-app` -> `.ops/scripts/audit.ts my-app` を実行。

## 2. 結果の分析

スクリプトの出力（標準出力・標準エラー出力）を読み、以下の観点で分析してください。

### A. リポジトリ全体監査（引数なし）の場合
1.  **ディレクトリ構造の乖離 (Gap)**: 
    - `AGENTS.md` で定義された理想的なディレクトリ構造と、現状の構造に乖離がないか。
    - 特に `apps/` 直下の配置が適切か（`agents/`, `web-bots/`, `tools/` 等に分類されているか）。
2.  **必須ファイルの欠落**:
    - `README.md`, `package.json` 等の基本ファイル。
    - `docs/issues/` 下のドキュメント（`requirements.md` 等）。
3.  **規約違反 (Violation)**:
    - ログファイル (`development_logs`) の言語設定（日本語であるか）。
    - 秘密情報の混入可能性。

### B. プロジェクト個別監査（引数あり）の場合
1.  **プロジェクト構成**:
    - 必要な設定ファイル (`package.json`, `tsconfig.json` 等) が揃っているか。
    - ソースコード (`src/`) とテストコードの対応関係（テストが欠落していないか）。
2.  **E2Eテスト結果**:
    - テストが成功したか (`Test Passed`)、失敗したか (`Test Failed`)。
    - 失敗した場合、エラーログから原因（タイムアウト、要素が見つからない、アサーションエラー等）を特定する。

## 3. レポートと改善提案

分析結果に基づき、以下のフォーマットでレポートを出力してください。

```markdown
# 監査レポート: [対象（リポジトリ全体 or プロジェクト名）]

## 1. 現状の概要
(スクリプト出力の要約。テスト成功可否や、構造上の主要な問題点)

## 2. 検出された課題
- [重要度: 高/中/低] 課題内容
  - 詳細: ...
  - 理由: ...

## 3. 推奨アクション
1. (具体的な修正案やコマンド)
2. (追加調査が必要な場合の指針)
```

**重要な注意事項**:
- このスキルは「分析と提案」までを責務とします。**ファイルの修正やコードの書き換えは行わないでください**（ユーザーに提案し、承認を得てから別のスキルや手動で行うべきです）。
- スクリプトがエラー終了した場合でも、出力されたログを分析し、なぜ失敗したかを説明してください。
